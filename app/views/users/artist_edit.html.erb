<style>
  #page-content{
    background: #fed853 !important;
  }
</style>
<% title "Settings" %>

<% if flash[:settings_notice] %>
  <div class="crayons-banner">
    <%= flash[:settings_notice] %>
  </div>
<% end %>

<% if flash[:error].present? %>
  <div class="crayons-banner crayons-banner--error">
    <%= flash[:error] %>
  </div>
<% end %>

<% if params[:state] == "previous-registration" %>
  <div class="crayons-banner crayons-banner--error">
    There is an existing account authorized with that social account. Contact
    <%= email_link %> if this is a mistake.
  </div>
<% end %>

<header class="crayons-layout crayons-layout--limited-l crayons-layout--1-col p-4">
  <h1 class="crayons-title">
    Settings for <a href="<%= user_url(@user) || "#" %>">@<%= @user.username.truncate(User::USERNAME_MAX_LENGTH) %></a>
  </h1>
</header>

<main class="crayons-layout crayons-layout--2-cols crayons-layout--limited-l pt-0">
  <div class="crayons-layout__left-sidebar">
    <nav class="hidden m:block">
      <% Constants::Settings::ARTIST_TAB_LIST.each do |possible_tab| %>
        <a class="crayons-link crayons-link--block <% if @tab == possible_tab.downcase.tr(' ', '-') %>crayons-link--current<% end %>" href="/artist_settings/<%= possible_tab.downcase.tr(" ", "-") %>">
          <%= possible_tab %>
        </a>
      <% end %>
    </nav>
    <div class="m:hidden p-2 pt-0">
      <select id="mobile-page-selector" class="crayons-select">
        <% Constants::Settings::ARTIST_TAB_LIST.each do |possible_tab| %>
          <option value="/artist_settings/<%= possible_tab.downcase.tr(" ", "-") %>" <% if @tab == possible_tab.downcase.tr(' ', '-') %> selected <% end %>>
            <%= possible_tab %>
          </option>
        <% end %>
      </select>
    </div>
  </div>

  <div class="crayons-layout__content">
    <% if current_user.email.blank? %>
      <div class="crayons-notice crayons-notice--warning mb-6">
        <h3 class="mb-2">Confirm your email to complete your profile.</h3>
      </div>
    <% end %>

    <% if @user.unconfirmed_email.present? %>
      <div class="crayons-notice crayons-notice--warning mb-6">
        <h3 class="mb-2">Email verification.</h3>
        <p>You have requested a change to <a href="mailto:<%= @user.unconfirmed_email %>"><%= @user.unconfirmed_email %></a>. Check your inbox for the verification link to finalize the change.</p>
      </div>
    <% end %>

    <% if @user.errors.any? %>
      <%= render partial: "users/errors", locals: { errors: @user.errors, title_suffix: "prohibited your profile from being saved" } %>
    <% end %>

    <%= render "users/#{@tab.tr('-', '_')}", tab: @tab %>
  </div>
</main>
