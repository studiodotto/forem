<style>
  #page-content{
    background: #fed853 !important;
  }
</style>
<% title "Settings" %>

<% if flash[:settings_notice] %>
  <div class="crayons-banner">
    <%= flash[:settings_notice] %>
  </div>
<% end %>

<% if flash[:error].present? %>
  <div class="crayons-banner crayons-banner--error">
    <%= flash[:error] %>
  </div>
<% end %>

<% if params[:state] == "previous-registration" %>
  <div class="crayons-banner crayons-banner--error">
    There is an existing account authorized with that social account. Contact
    <%= email_link %> if this is a mistake.
  </div>
<% end %>

<header class="crayons-layout crayons-layout--limited-l crayons-layout--1-col p-4">
  <h1 class="crayons-title">
<!--    Music Launcher <a href="<%#= user_url(@user) || "#" %>">@<%#= @user.username.truncate(User::USERNAME_MAX_LENGTH) %></a>-->
    Music Launcher >> <a href="/my-projects" style="color: black">Projects</a> >> <%= @organization.present? && @organization.music_releases.first.title ? @organization.music_releases.first.title : '' %>
  </h1>
</header>

<main class="crayons-layout crayons-layout--2-cols crayons-layout--limited-l pt-0">
  <div class="crayons-layout__left-sidebar">
    <nav class="hidden m:block">
      <%# Constants::Settings::ARTIST_TAB_LIST.each do |possible_tab| %>
<!--        <a href=""><%#= possible_tab %></a>-->

      <%# end %>
      <% Constants::Settings::ARTIST_TAB_LIST.each do |possible_tab| %>
        <% if current_user.has_role?(:artist) && !current_user.any_admin? %>
          <% if ["Profile and services", "Single Track Music Page", "My Projects", "Your Music Productions", "Raw N Uncut Music Page"].include?(possible_tab) %>
            <a class="crayons-link crayons-link--block <% if possible_tab == 'My Projects' %>crayons-link--current<% end %>" href="/artist_settings/<%= possible_tab.downcase.tr(" ", "-") %>">
              <% if possible_tab == "Single Track Music Page" %>
                Create a new single track
              <% elsif possible_tab == "Profile and services" %>
                Your profile
              <% elsif possible_tab == "My Projects" %>
                Projects
              <% elsif possible_tab == "Raw N Uncut Music Page" %>
                Create a RAW N UNCUT
              <% else %>
                <%= possible_tab %>
              <% end %>
            </a>
          <% end %>
        <% else %>
          <a class="crayons-link crayons-link--block <% if possible_tab == "My Projects" %>crayons-link--current<% end %>" href="/artist_settings/<%= possible_tab.downcase.tr(" ", "-") %>">
            <% if possible_tab == "Single Track Music Page" %>
              Create a new single track
            <% elsif possible_tab == "Profile and services" %>
              Your profile
            <% elsif possible_tab == "My Projects" %>
              Projects
            <% elsif possible_tab == "Raw N Uncut Music Page" %>
              Create a RAW N UNCUT
            <% else %>
              <%= possible_tab %>
            <% end %>
          </a>
        <% end %>
      <% end %>
    </nav>
    <div class="m:hidden p-2 pt-0">
      <select id="mobile-page-selector" class="crayons-select">
        <% Constants::Settings::ARTIST_TAB_LIST.each do |possible_tab| %>
          <% if current_user.has_role?(:artist) && !current_user.any_admin? %>
            <% if ["Profile and services", "Single Track Music Page", "My Projects", "Your Music Productions", "Raw N Uncut Music Page"].include?(possible_tab) %>
              <option value="/artist_settings/<%= possible_tab.downcase.tr(" ", "-") %>" <% if @tab == possible_tab.downcase.tr(' ', '-') %> selected <% end %>>
                <% if possible_tab == "Single Track Music Page" %>
                  Create a new single track
                <% elsif possible_tab == "Profile and services" %>
                  Your profile
                <% elsif possible_tab == "My Projects" %>
                  Projects
                <% elsif possible_tab == "Raw N Uncut Music Page" %>
                  Create a RAW N UNCUT
                <% else %>
                  <%= possible_tab %>
                <% end %>
              </option>
            <% end %>
          <% else %>
            <option value="/artist_settings/<%= possible_tab.downcase.tr(" ", "-") %>" <% if @tab == possible_tab.downcase.tr(' ', '-') %> selected <% end %>>
              <% if possible_tab == "Single Track Music Page" %>
                Create a new single track
              <% elsif possible_tab == "Profile and services" %>
                Your profile
              <% elsif possible_tab == "My Projects" %>
                Projects
              <% elsif possible_tab == "Raw N Uncut Music Page" %>
                Create a RAW N UNCUT
              <% else %>
                <%= possible_tab %>
              <% end %>
            </option>
          <% end %>
        <% end %>
      </select>
    </div>
  </div>

  <div class="crayons-layout__content">
    <% unless @user.confirmed? %>
      <div class="crayons-notice crayons-notice--warning mb-6" style="background: #0000009c; color: white; text-align: center">
        <h3 class="mb-2">Please verify your email address to access your unitedbits account.</h3>
      </div>
    <% end %>

    <% if @user.unconfirmed_email.present? %>
      <div class="crayons-notice crayons-notice--warning mb-6">
        <h3 class="mb-2">Email verification.</h3>
        <p>You have requested a change to <a href="mailto:<%= @user.unconfirmed_email %>"><%= @user.unconfirmed_email %></a>. Check your inbox for the verification link to finalize the change.</p>
      </div>
    <% end %>

    <% if @user.errors.any? %>
      <%= render partial: "users/errors", locals: { errors: @user.errors, title_suffix: "prohibited your profile from being saved" } %>
    <% end %>
    <% if @organization.try(:org_type).present? && @organization.try(:org_type) == 'uncut' %>
      <%= render partial: 'users/raw_n_uncut_music_page' %>
    <% elsif @organization.organization_type == 'single_track' %>
      <%= render partial: 'users/single_track_music_page' %>
    <% elsif @organization.organization_type == 'deejaying' %>
      <%= render partial: 'users/deejaying_services' %>
    <% elsif @organization.organization_type == 'online_music_services_page' %>
      <%= render partial: 'users/online_music_services_page' %>
    <% else %>
      <%= render partial: 'users/unreleased_music_project' %>
    <% end %>
  </div>
</main>

